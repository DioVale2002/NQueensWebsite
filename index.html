<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <title>N-Queens Problem Simulation</title>
</head>

<body>
  <div class="header">
    <h1>N-Queens Problem Simulation</h1>
  </div>

  <div class="controls">
    <label for="boardSize">Board Size (N):</label>
    <input type="number" id="boardSize" min="1" max="12" value="4">
    <button id="solveButton">Solve</button>
  </div>

  <div class="solution-count-div" id="solution-count-div">
    <h1 class="solution-count" id="solution-count"></h1>
    <h2 class="runtime-display" id="runtime-display"></h2>
  </div>
  <div class="board" id="chessboard"></div>
  <div class="solution-number-div" id="solution-number-div">
    <h1 class="solution-number" id="solution-number"></h1>
    <button class="btns" id="showTrackLog">Show TrackLog</button>
    <button class="btns" id="prevSolution"><img src="prev_button.png" alt="prevButton" class="btnImg"></button>
    <button class="btns" id="nextSolution"><img src="next_button.png" alt="nextButton" class="btnImg"></button>
  </div>

  <div id="trackLogModal" class="modal">
    <div class="modal-content">
      <span id="closeModalBtn" class="close">&times;</span>
      <h2>Trace Log</h2>
      <p id="traceParagraph"></p>
    </div>
  </div>

  <div class="explanation">
    <h2>About the N-Queens Problem:</h2>
    <p>The N-Queens puzzle is the problem of placing N chess queens on an N×N chessboard so that no two queens threaten
      each other. This means no two queens can share the same row, column, or diagonal.</p>
  </div>

  <script>
    const boardDiv = document.getElementById('chessboard');
    const solutionCurrentNumberDiv = document.getElementById('solution-number-div');
    const prevButton = document.getElementById('prevSolution');
    const nextButton = document.getElementById('nextSolution');
    const solutionCountDiv = document.getElementById('solution-count-div');
  
    let solutions = [];
    let solutionCount = 0;
  
    // Solve n-queens problem
    document.getElementById('solveButton').addEventListener('click', () => {
      const n = parseInt(document.getElementById('boardSize').value);
      if (n < 1 || n > 12) {
        alert('Please enter a board size between 1 and 12');
        return;
      }
  
      solutionCount = 0;
  
      const startTime = performance.now();
      solutions = solveNQueens(n);
      const endTime = performance.now();
      const runTime = (endTime - startTime).toFixed(2);
  
      document.getElementById('runtime-display').innerText = `⏱️ Solving took ${runTime} ms`;
      solutionCountDiv.style.display = 'block';
  
      displayBoard(solutionCount);
    });
  
    // Previous solution
    prevButton.addEventListener('click', () => {
      if (solutions.length > 0 && solutionCount > 0) {
        solutionCount--;
        displayBoard(solutionCount);
      }
    });
  
    // Next solution
    nextButton.addEventListener('click', () => {
      if (solutions.length > 0 && solutionCount < solutions.length - 1) {
        solutionCount++;
        displayBoard(solutionCount);
      }
    });
  
    function solveNQueens(n) {
      const result = [];
      const cols = new Set();
      const posDiag = new Set();
      const negDiag = new Set();
      const board = Array.from({ length: n }, () => Array(n).fill('.'));
  
      function backtrack(row) {
        if (row === n) {
          result.push(board.map(r => r.join('')));
          return;
        }
  
        for (let col = 0; col < n; col++) {
          if (cols.has(col) || posDiag.has(row + col) || negDiag.has(row - col)) continue;
  
          cols.add(col);
          posDiag.add(row + col);
          negDiag.add(row - col);
          board[row][col] = 'Q';
  
          backtrack(row + 1);
  
          cols.delete(col);
          posDiag.delete(row + col);
          negDiag.delete(row - col);
          board[row][col] = '.';
        }
      }
  
      backtrack(0);
      return result;
    }
  
    function displayBoard(solutionIndex) {
      if (!solutions || solutions.length === 0) {
        hideElements();
        solutionCountDiv.style.display = 'block';
        document.getElementById('solution-count').innerText = "No solutions found!";
        return;
      }
  
      if (solutions.length === 1) {
        hideButtons();
      } else {
        showElements();
        prevButton.style.visibility = solutionIndex === 0 ? 'hidden' : 'visible';
        nextButton.style.visibility = solutionIndex === solutions.length - 1 ? 'hidden' : 'visible';
      }
  
      showElements();
      document.getElementById('solution-count').innerText = `${solutions.length} Solution${solutions.length > 1 ? 's' : ''} Found!`;
      document.getElementById('solution-number').innerText = `Solution ${solutionIndex + 1}`;
  
      const N = solutions[0].length;
      boardDiv.innerHTML = '';
      boardDiv.style.gridTemplateColumns = `repeat(${N}, 1fr)`;
      boardDiv.style.gridTemplateRows = `repeat(${N}, 1fr)`;
  
      for (let row = 0; row < N; row++) {
        for (let col = 0; col < N; col++) {
          const cell = document.createElement('div');
          cell.classList.add('cell');
          cell.classList.add((row + col) % 2 === 0 ? 'white' : 'light-brown');
  
          if (solutions[solutionIndex][row][col] === 'Q') {
            const queen = document.createElement('img');
            queen.src = 'queen_Image.png';
            queen.alt = 'queen';
            queen.classList.add('queen');
            cell.appendChild(queen);
          }
  
          boardDiv.appendChild(cell);
        }
      }
    }
  
    function showElements() {
      solutionCountDiv.style.display = 'block';
      boardDiv.style.display = 'grid';
      solutionCurrentNumberDiv.style.display = 'flex';
      prevButton.style.display = 'block';
      nextButton.style.display = 'block';
    }
  
    function hideElements() {
      boardDiv.style.display = 'none';
      prevButton.style.display = 'none';
      nextButton.style.display = 'none';
      solutionCurrentNumberDiv.style.display = 'none';
    }
  
    function hideButtons() {
      prevButton.style.display = 'none';
      nextButton.style.display = 'none';
    }
  </script>
  
</body>

</html>